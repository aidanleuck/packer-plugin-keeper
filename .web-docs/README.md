<!--
  Include a short overview about the plugin.

  This document is a great location for creating a table of contents for each
  of the components the plugin may provide. This document should load automatically
  when navigating to the docs directory for a plugin.

-->

### Installation

To install this plugin, copy and paste this code into your Packer configuration, then run [`packer init`](https://www.packer.io/docs/commands/init).

```hcl
packer {
  required_plugins {
    keeper = {
      source  = "github.com/aidanleuck/keeper"
      version = ">=0.0.1"
    }
  }
}
```

Alternatively, you can use `packer plugins install` to manage installation of this plugin.

```sh
$ packer plugins install github.com/aidanleuck/keeper
```

#### Authenticating 

In order to authenticate with Keeper you must have a valid base 64 encoded access key to your Keeper Vault. A config file can be generated by following the [official Keeper documentation](https://docs.keeper.io/en/keeperpam/secrets-manager/about/secrets-manager-configuration). You can provide this config file to Packer in one of two ways.

1. Set the `KSM_CONFIG` environment variable to the base 64 contents of the config file. This would be equivalent to doing `export KSM_CONFIG=$(cat 'path-to-your-base-64-encoded-config')`
2. Set the `KEEPER_CONFIG_FILE` environment variable to the path to your base-64 encoded config file. This is equivalent to doing `export KEEPER_CONFIG_FILE='path-to-your-base-64-encoded-config'`

Only set one of these environment variables at a time.

### Components

The Keeper Packer plugin is a datasource plugin which allows you to inject credentials into your Packer templates using HCL.

#### Data Sources

- [keeper-login](./components/data-source/keeper_login/README.md) - The `keeper-login` datasource is used to retrieve a logon record type.
- [keeper-api-key](./components/data-source/keeper_api_key/README.md) - The `keeper-api-key` datasource is used to retrieve a api key record type.
- [keeper-database-credential](./components/data-source/keeper_database_credential/README.md) - The `keeper-database-credential` datasource is used to retrieve a database credential record type.
- [keeper-encrypted-note](./components/data-source/keeper_encrypted_note/README.md) - The `keeper-encrypted-note` datasource is used to retrieve a encrypted note/secret note record type.
- [keeper-file](./components/data-source/keeper_file/README.md) - The `keeper-file` datasource is used to retrieve a file record in Keeper.
- [keeper-server-credential](./components/data-source/keeper_server_credentials/README.md) - The `keeper-server-credential` datasource is used to retrieve a server record in Keeper.
- [keeper-software-license](./components/data-source/keeper_software_license/README.md) - The `keeper-software-license` datasource is used to retrieve a software license record in Keeper.


